(this.webpackJsonploopin=this.webpackJsonploopin||[]).push([[0],{33:function(e,t,n){e.exports=n(58)},38:function(e,t,n){},56:function(e,t,n){},58:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(7),i=n.n(o),c=(n(38),n(6)),u=n(30),s=n(12),l=n.n(s),p=n(3),d=n(4);function m(){var e=Object(p.a)(["\n  ","\n"]);return m=function(){return e},e}function f(){var e=Object(p.a)(["\n  display: flex;\n"]);return f=function(){return e},e}var b=d.a.div(f()),y=d.a.div(m(),(function(e){return e.active&&"\n    color: green;\n    font-weight: bold;\n  "})),v=function(e){var t=e.playBeat,n=e.step;return a.a.createElement(b,null,t&&t.map((function(e,t){return a.a.createElement(y,{active:t===n,key:t},e)}))||null)};function O(){var e=Object(p.a)(["\n  background-color: lightgray;\n  border: solid 1px gray;\n  border-radius: 4px;\n\n  ","\n"]);return O=function(){return e},e}var g=d.a.button(O(),(function(e){return e.active&&"\n    background-color: green;\n  "}));function h(){var e=Object(p.a)(["\n  display: flex;\n"]);return h=function(){return e},e}var j=d.a.div(h()),w=function(e){var t=e.muted,n=e.setMuted;return a.a.createElement(j,null,a.a.createElement(g,{onClick:function(){return n(!t)},active:t},"Mute"))};function k(){var e=Object(p.a)(["\n  flex: 0 0 auto;\n  width: 100px;\n  text-overflow: ellipsis;\n  overflow: hidden;\n"]);return k=function(){return e},e}function E(){var e=Object(p.a)(["\n  display: flex;\n\n  * {\n    flex: 1 1 auto;\n  }\n\n  "," {\n    flex: 0 0 auto;\n  }\n"]);return E=function(){return e},e}var x,I,D=d.a.div(E(),j),P=d.a.b(k()),N=D;!function(e){e.all="all",e.odd="odd",e.even="even",e.oddQuarter="quarter",e.evenQuarter="evenQuarter",e.first="first",e.last="last"}(x||(x={})),function(e){e[e.drum=110]="drum",e[e.bass=120]="bass",e[e.string=130]="string",e[e.key=190]="key",e[e.recording=101]="recording",e[e.other=900]="other"}(I||(I={}));var S,_,B,C,T,M,A=n(27),L=n(8),R=n(10),z=n(11),Q=n(5),W=(n(55),n(2));function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var J,F=[],H=function(e){return F.slice().concat.apply([],e)},K=(S=function(){function e(){Object(R.a)(this,e),Object(L.a)(this,"tracks",_,this),Object(L.a)(this,"add",B,this),Object(L.a)(this,"remove",C,this),Object(L.a)(this,"update",T,this),Object(L.a)(this,"mute",M,this)}return Object(z.a)(e,[{key:"_update",value:function(e){console.log("_update",e),this.tracks=this.tracks.slice().map((function(t){return t.name===e.name?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){Object(A.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t,{},e):t})),console.log("this.tracks",this.tracks)}},{key:"_remove",value:function(e){console.log("remove ",e)}},{key:"_add",value:function(e){console.log("add new ",e)}},{key:"drums",get:function(){return this.tracks.filter((function(e){return e.type===I.drum}))}},{key:"drumInstrumentIds",get:function(){return H(this.drums.map((function(e){return e.instrument})))}},{key:"bassers",get:function(){return this.tracks.filter((function(e){return e.type===I.bass}))}},{key:"bassersInstrumentIds",get:function(){return H(this.bassers.map((function(e){return e.instrument})))}},{key:"recordings",get:function(){return this.tracks.filter((function(e){return e.type===I.recording}))}}]),e}(),_=Object(Q.a)(S.prototype,"tracks",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[{name:"kickdrum",type:I.drum,instrument:1,divider:2,playType:x.oddQuarter},{name:"kickdrum variety",type:I.drum,instrument:1,divider:2,playBeat:[0,1,0,0,0,1,0,0,0,0,0,1,0,0,0,1]},{name:"snaredrum",type:I.drum,instrument:16,divider:1,playType:x.even},{name:"cin",type:I.drum,instrument:39,divider:4,playType:x.even},{name:"korgbass 2",type:I.bass,instrument:371,pitches:[30],duration:1,divider:4,playType:x.odd},{name:"quitar1",type:I.bass,instrument:307,duration:1,divider:2,playBeat:[50,0,53,54,55,0,50,0,50,0,53,54,55,0,50,0,50,0,53,54,55,0,50,0,51,0,54,55,56,0,52,0]}]}}),Object(Q.a)(S.prototype,"drums",[W.e],Object.getOwnPropertyDescriptor(S.prototype,"drums"),S.prototype),Object(Q.a)(S.prototype,"drumInstrumentIds",[W.e],Object.getOwnPropertyDescriptor(S.prototype,"drumInstrumentIds"),S.prototype),Object(Q.a)(S.prototype,"bassers",[W.e],Object.getOwnPropertyDescriptor(S.prototype,"bassers"),S.prototype),Object(Q.a)(S.prototype,"bassersInstrumentIds",[W.e],Object.getOwnPropertyDescriptor(S.prototype,"bassersInstrumentIds"),S.prototype),Object(Q.a)(S.prototype,"recordings",[W.e],Object.getOwnPropertyDescriptor(S.prototype,"recordings"),S.prototype),Object(Q.a)(S.prototype,"_update",[W.d],Object.getOwnPropertyDescriptor(S.prototype,"_update"),S.prototype),Object(Q.a)(S.prototype,"_remove",[W.d],Object.getOwnPropertyDescriptor(S.prototype,"_remove"),S.prototype),Object(Q.a)(S.prototype,"_add",[W.d],Object.getOwnPropertyDescriptor(S.prototype,"_add"),S.prototype),B=Object(Q.a)(S.prototype,"add",[W.d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this._add.bind(this)}}),C=Object(Q.a)(S.prototype,"remove",[W.d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this._remove.bind(this)}}),T=Object(Q.a)(S.prototype,"update",[W.d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this._update.bind(this)}}),M=Object(Q.a)(S.prototype,"mute",[W.d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this._update.bind(this)}}),S),U=(J=function(){function e(){Object(R.a)(this,e)}return Object(z.a)(e,[{key:"step",get:function(){return 0}}]),e}(),Object(Q.a)(J.prototype,"step",[W.e],Object.getOwnPropertyDescriptor(J.prototype,"step"),J.prototype),J),V={trx:new K,mtn:new U},$=Object(r.createContext)(V),G=function(e){var t=e.bpm,n=e.metronomeBpm,o=e.looping,i=void 0===o||o,u=e.rythmLength,s=e.playType,l=void 0===s?x.odd:s,p=e.playBeat,d=e.source,m=e.step,f=e.render,b=e.name,y=e.duration,O=e.muted,g=t&&n&&t/n||1,h=(m||0)*g,j=Object(r.useContext)($).trx,k=f||v,E=Object(r.useState)(p&&p.slice()||function(e){var t=e.playType,n=(e.rythmLength||0)*e.multiplier;switch(t){case x.odd:return new Array(n).fill(0).map((function(e,t){return 1-t%2}));case x.even:return new Array(n).fill(0).map((function(e,t){return t%2}));case x.oddQuarter:return new Array(n).fill(0).map((function(e,t){return t%4?0:1}));case x.evenQuarter:return new Array(n).fill(0).map((function(e,t){return t%4===2?1:0}));case x.first:return new Array(n).fill(0).map((function(e,t){return 0===t?1:0}));case x.last:return new Array(n).fill(0).map((function(e,t){return t===n-1?1:0}));case x.all:default:return new Array(n).fill(1)}}({playType:l,rythmLength:u,multiplier:g})),I=Object(c.a)(E,2),D=I[0],S=I[1];return Object(r.useEffect)((function(){i&&D[h]&&d&&!O&&d({pitches:[D[h]],duration:y})}),[m,i]),a.a.createElement(N,null,a.a.createElement(P,null,b),a.a.createElement(w,{muted:!!O,setMuted:function(){return j.mute({name:b,muted:!O})}}),a.a.createElement(k,{playBeat:D,step:h,setPlayBeat:function(e){return S(e)}}))},X=(n(56),function(e){var t=e.bpm,n=void 0===t?60:t,o=e.looping,i=void 0===o||o,u=e.rythmLength,s=void 0===u?8:u,l=e.rythmDivider,p=void 0===l?16:l,d=e.children,m=Object(r.useState)(new Date),f=Object(c.a)(m,2),b=f[0],y=f[1],v=Object(r.useState)(0),O=Object(c.a)(v,2),g=O[0],h=O[1],j=Object(r.useState)(),w=Object(c.a)(j,2),k=w[0],E=w[1],x=60/n*1e3;Object(r.useEffect)((function(){i&&(y(new Date),k&&clearTimeout(k),E(setInterval((function(){return function(){var e=((new Date).getTime()-b.getTime())/x,t=Math.floor(e)%s,n=Math.floor((e-Math.floor(e))*s)/8;h(t+n)}()}),x/p)))}),[x,i]);var I=a.a.Children.map(d,(function(e){return a.a.cloneElement(e,{metronomeBpm:n,step:g,rythmLength:s})}));return a.a.createElement(a.a.Fragment,null,a.a.createElement("h1",null,g),I)});function Y(){var e=Object(p.a)(["\n  border-radius: 4px;\n  border: solid 1px black;\n  background: gray;\n  margin: 3px;\n  flex: 1 1 auto;\n  height: 50px;\n  overflow: hidden;\n  color: #515e2d;\n\n  ","\n\n  ","\n  ","\n"]);return Y=function(){return e},e}function Z(){var e=Object(p.a)(["\n  display: flex;\n"]);return Z=function(){return e},e}var ee=d.a.div(Z()),te=d.a.button(Y(),(function(e){return!e.enabled&&e.active&&"\n    background: #999;\n  "}),(function(e){return e.enabled&&"\n    background: #515e2d;\n  "}),(function(e){return e.enabled&&e.active&&"\n    background: rgb(180,193,38);\n    background: radial-gradient(circle, rgba(180,193,38,1) 35%, rgba(112,125,76,1) 100%);\n  "})),ne=function(e){var t=e.playBeat,n=e.step,r=e.setPlayBeat;return a.a.createElement(ee,null,t&&t.map((function(e,o){return a.a.createElement(te,{active:o===n,enabled:e>0,key:o,onClick:function(){return function(e){if(r){var n=t.slice();n[e]=n[e]?0:1,r(n)}}(o)}},e)}))||null)};function re(){var e=Object(p.a)(["\n  display: flex;\n  font-size: 2rem;\n  font-weight: bold;\n  align-items: center;\n  justify-content: flex-start;\n\n  ","\n\n  .MIDISounds {\n    margin: 0px 10px;\n    &>* {\n      display: flex;\n      align-items: center;\n\n      &:after {\n        content: 'config';\n        font-size: initial;\n      }\n    }\n    svg {\n      width: 40px;\n      height: 30px;\n    }\n  }\n"]);return re=function(){return e},e}var ae=d.a.section(re(),(function(e){return e.title&&"\n    &:before {\n      content: '".concat(e.title,":';\n      text-decoration: underline;\n    }\n  ")})),oe=n(9),ie=(n(57),function(e){var t=e.playNote,n=oe.b.fromNote("c3"),r=oe.b.fromNote("f5"),o=oe.a.create({firstNote:n,lastNote:r,keyboardConfig:oe.a.HOME_ROW});return a.a.createElement(oe.c,{noteRange:{first:n,last:r},playNote:t,stopNote:function(e){},width:document.body.clientWidth,keyboardShortcuts:o})});function ce(){var e=Object(p.a)([""]);return ce=function(){return e},e}var ue=d.a.div(ce()),se=function(){return a.a.createElement(ue,null,"TODO:SLIDER")},le=n(29),pe=n(28),de=n.n(pe),me=function(){var e=Object(r.useState)(!1),t=Object(c.a)(e,2),n=t[0],o=t[1],i=Object(r.useState)(""),u=Object(c.a)(i,2),s=u[0],l=u[1];return a.a.createElement(N,null,!n&&a.a.createElement(g,{onClick:function(){return o(!0)}},"Record"),n&&a.a.createElement(g,{onClick:function(){return o(!1)}},"stop"),a.a.createElement(le.a,{record:n,visualSetting:"sinewave",onStop:function(e){var t=de()(e,"blobURL","");l(t)}}),s&&a.a.createElement("audio",{controls:!0},a.a.createElement("track",{kind:"captions"}),a.a.createElement("source",{src:s,type:"audio/webm"})))},fe=Object(u.a)((function(){var e=Object(r.useRef)(null),t=Object(r.useRef)(null),n=Object(r.useRef)(null),o=Object(r.useState)(847),i=Object(c.a)(o,2),u=i[0],s=i[1],p=Object(r.useState)(80),d=Object(c.a)(p,2),m=d[0],f=d[1],b=Object(r.useContext)($).trx,y=function(e){if(null!==n&&null!==n.current){var t=[].concat(e);n.current.playChordNow(u,t,.5)}};return a.a.createElement("div",{className:"App"},"set BPM: ",a.a.createElement("input",{type:"number",value:m,onChange:function(e){return f(parseInt(e.target.value,10))},min:30,max:300}),a.a.createElement(se,null),a.a.createElement(X,{bpm:m},a.a.createElement(ae,{title:"Drums"},a.a.createElement(l.a,{ref:e,appElementName:"root",drums:b.drumInstrumentIds})),b.drums.map((function(t){return a.a.createElement(G,Object.assign({},t,{key:t.name,bpm:m*t.divider,source:function(){return e.current&&e.current.playDrumsNow([t.instrument])},render:ne}))})),a.a.createElement(ae,{title:"Bass"},a.a.createElement(l.a,{ref:t,appElementName:"root",instruments:b.bassersInstrumentIds})),b.bassers.map((function(t){return a.a.createElement(G,Object.assign({},t,{key:t.name,bpm:m*t.divider,source:function(n){var r=n.pitches,a=n.duration;return e.current&&e.current.playChordNow(t.instrument,t.pitches||r||[30],a||1)},render:ne}))})),a.a.createElement(ae,{title:"Voice"},b.recordings.map((function(t){return a.a.createElement(G,Object.assign({},t,{key:t.name,bpm:m*t.divider,source:function(n){var r=n.pitches,a=n.duration;return e.current&&e.current.playChordNow(t.instrument,t.pitches||r||[30],a||1)},render:ne}))})),a.a.createElement(me,null))),a.a.createElement(ae,{title:"Keys"},a.a.createElement(l.a,{ref:n,appElementName:"root",instruments:[1,2,3,305,847]}),a.a.createElement("input",{type:"number",value:u,onChange:function(e){return t=parseInt(e.target.value,10),console.log("trying to cache instrument",t),n.current&&(n.current.cacheInstrument(t),n.current.player.loader.waitLoad((function(){return y(50)}))),void s(t);var t},min:0,max:1393})),a.a.createElement(ie,{playNote:function(e){return y(e)}}))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(fe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[33,1,2]]]);
//# sourceMappingURL=main.57f7b604.chunk.js.map