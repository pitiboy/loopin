{"version":3,"sources":["DefaultLooperRenderer.tsx","LooperStyles.tsx","ControlButton.tsx","model/types.ts","LooperControls.tsx","model/stores/TrackStore.ts","model/stores/MetronomeStore.ts","model/stores/index.ts","Looper.tsx","Controls/Metronome.tsx","SquareLooperRenderer.tsx","Layout/Section.tsx","Layout/PianoKeyboard.tsx","Controls/RootControls.tsx","Controls/MicRecorder.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["DefaultRythmStyles","styled","div","DefaultBeatStyles","props","active","playBeat","step","map","beat","index","key","LooperControlStyles","LooperStyles","Name","b","PlayTypes","TrackType","ControlButton","button","DefaultLooperControl","name","muted","setMuted","children","onClick","defaultArray","flattenArray","array","slice","concat","apply","console","log","process","TrackStore","track","this","tracks","t","filter","type","drum","drums","instrument","bass","bassers","recording","observable","divider","playType","oddQuarter","even","pitches","duration","odd","computed","action","_add","bind","_remove","_update","MetronomeStore","stores","trx","mtn","createContext","bpm","metronomeBpm","looping","rythmLength","originalPlayBeat","source","playSound","renderProp","render","controlProp","control","multiplier","getStep","useContext","StoreContext","LooperRenderer","DefaultLooperRenderer","ControlRenderer","useState","length","Array","fill","_qwe","evenQuarter","first","last","all","generatePlayBeat","setPlayBeat","useEffect","mute","thisPlayBeat","rythmDivider","defaultRrythmLength","Date","start","setStart","setStep","metronome","setMetronome","interval","clearTimeout","setInterval","diff","getTime","newStep","Math","floor","calculateStep","newChildren","React","Children","child","cloneElement","RythmStyles","BeatStyles","enabled","newPlayBeat","updateBeat","section","title","playNote","firstNote","MidiNumbers","fromNote","lastNote","keyboardShortcuts","KeyboardShortcuts","create","keyboardConfig","HOME_ROW","noteRange","stopNote","midiNumber","width","document","body","clientWidth","RootControlsStyles","recorder","Recorder","wasmURL","setRecording","StoresContext","startRecording","a","initAudio","initWorker","stopRecording","blob","blobUrl","window","URL","createObjectURL","replace","add","audioNode","querySelector","currentTime","play","e","error","setTimeout","close","App","observer","midiDrums","useRef","midiBass","midiKeys","pianoChord","setPianoChord","myBPM","setMyBPM","playChord","current","playPitches","playChordNow","className","value","onChange","parseInt","target","min","max","RootControls","Metronome","Section","ref","appElementName","drumInstrumentIds","Looper","playDrumsNow","SquareLooperRenderer","instruments","bassersInstrumentIds","chord","MicRecorder","recordings","id","controls","src","cacheInstrument","player","loader","waitLoad","PianoKeyboard","note","Boolean","location","hostname","match","ReactDOM","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"ubAKO,IAAMA,EAAqBC,IAAOC,IAAV,KAIlBC,EAAoBF,IAAOC,IAAV,KAC1B,SAAAE,GAAK,OAAIA,EAAMC,QAAN,qDAME,kBAAGC,EAAH,EAAGA,SAAUC,EAAb,EAAaA,KAAb,OACb,kBAACP,EAAD,KACIM,GAAYA,EAASE,KAAI,SAACC,EAAMC,GAAP,OAAiB,kBAACP,EAAD,CAAmBE,OAAQK,IAAUH,EAAMI,IAAKD,GAAQD,OAA+B,O,gdChBhI,IAAMG,EAAsBX,IAAOC,IAAV,KAI1BW,EAAeZ,IAAOC,IAAV,IAOdU,GAKSE,EAAOb,IAAOc,EAAV,KAaFF,I,kKCvBR,ICNKG,EAWAC,EDLCC,EAAgBjB,IAAOkB,OAAV,KAKtB,SAAAf,GAAK,OAAIA,EAAMC,QAAN,wCEHAe,EAAuB,SAAC,GAAD,IAClCC,EADkC,EAClCA,KAAMC,EAD4B,EAC5BA,MAAOC,EADqB,EACrBA,SAAUC,EADW,EACXA,SADW,OAGlC,kBAACZ,EAAD,KACE,kBAACE,EAAD,KACGO,EAEAG,GAEH,kBAACN,EAAD,CAAeO,QAAS,kBAAMF,GAAUD,IAAQjB,OAAQiB,GAAxD,W,SDjBQN,K,UAAAA,E,UAAAA,E,YAAAA,E,qBAAAA,E,0BAAAA,E,cAAAA,E,aAAAA,M,cAWAC,O,iBAAAA,I,iBAAAA,I,qBAAAA,I,eAAAA,I,2BAAAA,I,oBAAAA,M,uSE4BZ,IAAMS,EAAyB,GACzBC,EAAe,SAACC,GAAD,OAAkCF,EAAaG,QAAQC,OAAOC,MAAM,GAAIH,IAE7FI,QAAQC,IAAI,2BAA4BC,S,MAGnBC,G,uQAkGHC,GACdJ,QAAQC,IAAI,UAAWG,GACvBC,KAAKC,OAASD,KAAKC,OAAOT,QAAQrB,KAAI,SAAA+B,GAAC,OAAKA,EAAElB,OAASe,EAAMf,K,yWAAjB,IAA6BkB,EAA7B,GAAmCH,GAASG,O,8BAI1EH,GACdJ,QAAQC,IAAI,UAAWG,K,2BAGZA,GACXJ,QAAQC,IAAI,WAAYG,GACxBC,KAAKC,OAASD,KAAKC,OAAOT,QAAQC,OAAOM,K,4BAlCzC,OAAOC,KAAKC,OACTE,QAAO,SAAAJ,GAAK,OAAIA,EAAMK,OAASxB,EAAUyB,U,wCAI5C,OAAOf,EAAaU,KAAKM,MAAMnC,KAAI,SAAA4B,GAAK,OAAIA,EAAMQ,iB,8BAIlD,OAAOP,KAAKC,OACTE,QAAO,SAAAJ,GAAK,OAAIA,EAAMK,OAASxB,EAAU4B,U,2CAI5C,OAAOlB,EAAaU,KAAKS,QAAQtC,KAAI,SAAA4B,GAAK,OAAIA,EAAMQ,iB,iCAIpD,OAAOP,KAAKC,OACTE,QAAO,SAAAJ,GAAK,OAAIA,EAAMK,OAASxB,EAAU8B,iB,yCA1F7CC,K,wEAAkC,CAAC,CAClC3B,KAAM,WACNoB,KAAMxB,EAAUyB,KAChBE,WAAY,EACZK,QAAS,EACTC,SAAUlC,EAAUmC,WACpB7B,OAAOY,GAET,CACEb,KAAM,mBACNoB,KAAMxB,EAAUyB,KAChBE,WAAY,EACZK,QAAS,EACT3C,SAAU,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACxDgB,OAAOY,GAET,CACEb,KAAM,MACNoB,KAAMxB,EAAUyB,KAChBE,WAAY,GACZK,QAAS,EACTC,SAAUlC,EAAUoC,KACpB9B,OAAOY,GAET,CACEb,KAAM,YACNoB,KAAMxB,EAAUyB,KAChBE,WAAY,GACZK,QAAS,EACTC,SAAUlC,EAAUoC,KACpB9B,OAAOY,GAWT,CACEb,KAAM,aACNoB,KAAMxB,EAAU4B,KAChBD,WAAY,IACZS,QAAS,CAAC,IACVC,SAAU,EACVL,QAAS,EACTC,SAAUlC,EAAUuC,IACpBjC,OAAOY,GAET,CACEb,KAAM,UACNoB,KAAMxB,EAAU4B,KAChBD,WAAY,IACZU,SAAU,EACVL,QAAS,EACT3C,SAAU,CACR,GAAI,EAAG,GAAI,GAAI,GAAI,EAAG,GAAI,EAC1B,GAAI,EAAG,GAAI,GAAI,GAAI,EAAG,GAAI,EAC1B,GAAI,EAAG,GAAI,GAAI,GAAI,EAAG,GAAI,EAC1B,GAAI,EAAG,GAAI,GAAI,GAAI,EAAG,GAAI,GAK5BgB,OAAOY,O,iCAIRsB,K,+GAKAA,K,iHAIAA,K,oHAKAA,K,uHAIAA,K,0GAKAC,K,uGAMAA,K,oGAIAA,K,kGAMAA,K,yEAAapB,KAAKqB,KAAKC,KAAKtB,S,oCAE5BoB,K,yEAAgBpB,KAAKuB,QAAQD,KAAKtB,S,oCAElCoB,K,yEAAgBpB,KAAKwB,QAAQF,KAAKtB,S,kCAElCoB,K,yEAAcpB,KAAKwB,QAAQF,KAAKtB,S,GCnKdyB,G,+FAEjB,OAAO,M,qCADRN,K,oECEGO,EAAS,CACbC,IAHiB,IAAI7B,EAIrB8B,IAHqB,IAAIH,GAOZI,0BAAcH,GC0Dd,cAgBK,IAflBI,EAeiB,EAfjBA,IACAC,EAciB,EAdjBA,aAciB,IAbjBC,eAaiB,SAZjBC,EAYiB,EAZjBA,YAYiB,IAXjBpB,gBAWiB,MAXNlC,EAAUuC,IAWJ,EAVPgB,EAUO,EAVjBjE,SACAkE,EASiB,EATjBA,OACAC,EAQiB,EARjBA,UACAlE,EAOiB,EAPjBA,KACQmE,EAMS,EANjBC,OACSC,EAKQ,EALjBC,QACAxD,EAIiB,EAJjBA,KACAiC,EAGiB,EAHjBA,SACAhC,EAEiB,EAFjBA,MACAE,EACiB,EADjBA,SAEMsD,EAAcX,GAAOC,GAAgBD,EAAMC,GAAiB,EAC5DW,GAAWxE,GAAQ,GAAKuE,EACtBd,EAAQgB,qBAAWC,GAAnBjB,IACFkB,EAAiBR,GAAcS,EAC/BC,EAAkBR,GAAexD,EALtB,EAMeiE,mBAAUd,GAAoBA,EAAiB1C,SA7CxD,SAAC,GAA4E,IAA1EqB,EAAyE,EAAzEA,SACpBoC,GAD6F,EAA/DhB,aACL,GADoE,EAAlDQ,WAGjD,OAAQ5B,GACR,KAAKlC,EAAUuC,IACb,OAAO,IAAIgC,MAAMD,GAAQE,KAAK,GAAGhF,KAAI,SAACiF,EAAM/E,GAAP,OAAiB,EAAKA,EAAQ,KACrE,KAAKM,EAAUoC,KACb,OAAO,IAAImC,MAAMD,GAAQE,KAAK,GAAGhF,KAAI,SAACiF,EAAM/E,GAAP,OAAiBA,EAAQ,KAChE,KAAKM,EAAUmC,WACb,OAAO,IAAIoC,MAAMD,GAAQE,KAAK,GAAGhF,KAAI,SAACiF,EAAM/E,GAAP,OAAkBA,EAAQ,EAAI,EAAI,KACzE,KAAKM,EAAU0E,YACb,OAAO,IAAIH,MAAMD,GAAQE,KAAK,GAAGhF,KAAI,SAACiF,EAAM/E,GAAP,OAAkBA,EAAQ,IAAM,EAAI,EAAI,KAC/E,KAAKM,EAAU2E,MACb,OAAO,IAAIJ,MAAMD,GAAQE,KAAK,GAAGhF,KAAI,SAACiF,EAAM/E,GAAP,OAA4B,IAAVA,EAAc,EAAI,KAC3E,KAAKM,EAAU4E,KACb,OAAO,IAAIL,MAAMD,GAAQE,KAAK,GAAGhF,KAAI,SAACiF,EAAM/E,GAAP,OAAkBA,IAAU4E,EAAS,EAAI,EAAI,KACpF,KAAKtE,EAAU6E,IACf,QACE,OAAO,IAAIN,MAAMD,GAAQE,KAAK,IA2B0DM,CAAiB,CAAE5C,WAAUoB,cAAaQ,gBANnH,mBAMVxE,EANU,KAMAyF,EANA,KAuBjB,OANAC,qBAAU,WACJ3B,GARA/D,EAASyE,KAAazD,IACpBkD,GAAQA,EAAO,CAAEnB,QAAS,CAAC/C,EAASyE,IAAWzB,aAC/CmB,GAAWA,OAShB,CAAClE,EAAM8D,IAGR,kBAAC,EAAD,KACE,kBAACe,EAAD,CAAiB9D,QAASA,EAAOC,SAlBpB,kBAAMyC,EAAIiC,KAAK,CAAE5E,OAAMC,OAAQA,KAkBSD,KAAMA,GAAOG,GAClE,kBAAC0D,EAAD,CAAgB5E,SAAUA,EAAUC,KAAMwE,EAASgB,YAAa,SAACG,GAAD,OAAkBH,EAAYG,QClGrF,G,MAAA,YAMK,IAAD,IALjB/B,WAKiB,MARO,GAQP,MAJjBE,eAIiB,aAHjBC,mBAGiB,MAVS,EAUT,MAFjB6B,oBAEiB,MAFFC,GAEE,EADjB5E,EACiB,EADjBA,SACiB,EACS6D,mBAAS,IAAIgB,MADtB,mBACVC,EADU,KACHC,EADG,OAEOlB,mBAAS,GAFhB,mBAEV9E,EAFU,KAEJiG,EAFI,OAGiBnB,qBAHjB,mBAGVoB,EAHU,KAGCC,EAHD,KAIXC,EAAY,GAAKxC,EAAO,IAc9B6B,qBAAU,WACJ3B,IAZJkC,EAAS,IAAIF,MAePI,GAAWG,aAAaH,GAE5BC,EAAaG,aAAY,kBAdP,WACpB,IAAMC,IAAQ,IAAIT,MAAOU,UAAYT,EAAMS,WAAaJ,EAClDK,EAAUC,KAAKC,MAAMJ,GAAQxC,EAC7BrB,EAAUgE,KAAKC,OAAOJ,EAAOG,KAAKC,MAAMJ,IAASxC,GAAe,EAEtEkC,EAAQQ,EAAU/D,GASekE,KAAiBR,EAAWR,OAE5D,CAACQ,EAAUtC,IAEd,IAAM+C,EAAcC,IAAMC,SAAS9G,IAAIgB,GAAU,SAAA+F,GAAK,OAAIF,IAAMG,aAAaD,EAAO,CAClFnD,aAAcD,EACd5D,OACA+D,mBAGF,OACE,oCACE,4BAAK/D,GACJ6G,K,6VCrDA,IAAMK,GAAcxH,IAAOC,IAAV,KAIXwH,GAAazH,IAAOkB,OAAV,KAUnB,SAAAf,GAAK,OAAKA,EAAMuH,SAAWvH,EAAMC,QAAxB,iCAIT,SAAAD,GAAK,OAAIA,EAAMuH,SAAN,oCAGT,SAAAvH,GAAK,OAAIA,EAAMuH,SAAWvH,EAAMC,QAAvB,uIAOE,eAA2D,IAAxDC,EAAuD,EAAvDA,SAAUC,EAA6C,EAA7CA,KAAMwF,EAAuC,EAAvCA,YAOhC,OACE,kBAAC0B,GAAD,KACInH,GAAYA,EAASE,KAAI,SAACC,EAAMC,GAAP,OAAiB,kBAACgH,GAAD,CAAYrH,OAAQK,IAAUH,EAAMoH,QAASlH,EAAO,EAAGE,IAAKD,EAAOe,QAAS,kBARzG,SAACf,GAClB,GAAKqF,EAAL,CACA,IAAM6B,EAActH,EAASuB,QAC7B+F,EAAYlH,GAAUkH,EAAYlH,GAAa,EAAJ,EAC3CqF,EAAY6B,IAIoHC,CAAWnH,KAASD,OAAwB,O,ycCxCjKR,WAAO6H,QAAtB,MAOI,SAAA1H,GAAK,OAAIA,EAAM2H,OAAN,4CAEK3H,EAAM2H,MAFX,wD,SCDE,I,MAAA,YAAuC,IAApCC,EAAmC,EAAnCA,SACVC,EAAYC,KAAYC,SAAS,MACjCC,EAAWF,KAAYC,SAAS,MAChCE,EAAoBC,KAAkBC,OAAO,CACjDN,UAAWA,EACXG,SAAUA,EACVI,eAAgBF,KAAkBG,WAGpC,OACE,kBAAC,KAAD,CACEC,UAAW,CAAE/C,MAAOsC,EAAWrC,KAAMwC,GACrCJ,SAAUA,EACVW,SAAU,SAACC,KAGXC,MAAOC,SAASC,KAAKC,YACrBX,kBAAmBA,M,uECtBzB,IAAMY,GAAqBhJ,IAAOC,IAAV,MAET,qBACb,kBAAC+I,GAAD,qB,6BCMIC,GAAW,I,MAAIC,GAAS,CAC5BC,QAAS,2CAkBI,cAAO,IAAD,EACe/D,oBAAS,GADxB,mBACZtC,EADY,KACDsG,EADC,KAGXrF,EAAQgB,qBAAWsE,GAAnBtF,IA+CFuF,EAAc,yCAAG,uBAAAC,EAAA,6DACrBH,GAAa,GADQ,SAEfH,GAASO,YAFM,uBAGfP,GAASQ,aAHM,OAIrBR,GAASK,iBAJY,2CAAH,qDAOdI,EAAa,yCAAG,iCAAAH,EAAA,6DACpBH,GAAa,GADO,SAEDH,GAASS,gBAFR,OAEdC,EAFc,OAGdC,EAAUC,OAAOC,IAAIC,gBAAgBJ,GACrCvI,EAJc,YAIFwI,EAAQI,QAAQ,MAAO,KAEzCjG,EAAIkG,IAAI,CACN7I,OACAoB,KAAMxB,EAAU8B,UAChBE,QAAS,EACTL,WAAY,EACZiH,UACA3G,SAAUlC,EAAU2E,MACpBlB,UAAW,WACT,IAAM0F,EAAYrB,SAASsB,cAAT,WAA2B/I,IAC7C,GAAI8I,EAEF,IACGA,EAA+BE,YAAY,EAC3CF,EAA+BG,OAChC,MAAOC,GACPvI,QAAQwI,MAAMD,OAOtBE,YAAW,WAETvB,GAASwB,UACR,KA/BiB,2CAAH,qDA0DnB,OACE,kBAAC,EAAD,MACI3H,GAAa,kBAAC7B,EAAD,CAAeO,QAAS,kBAAM8H,MAA9B,UACdxG,GAAa,kBAAC7B,EAAD,CAAeO,QAAS,kBAAMkI,MAA9B,UC5ELgB,GA1DOC,aAAS,WAC7B,IAAMC,EAAYC,iBAAuB,MACnCC,EAAWD,iBAAuB,MAClCE,EAAWF,iBAAuB,MAHL,EAICzF,mBAAS,KAJV,mBAI5B4F,EAJ4B,KAIhBC,EAJgB,OAKT7F,mBAAS,IALA,mBAK5B8F,EAL4B,KAKrBC,EALqB,KAM3BpH,EAAQgB,qBAAWC,GAAnBjB,IAGFqH,EAAY,SAAChI,GACjB,GAAiB,OAAb2H,GAA0C,OAArBA,EAASM,QAAkB,CAClD,IACMC,EAD2B,GACEzJ,OAAOuB,GAC1C2H,EAASM,QAAQE,aAAaP,EAAYM,EAAa,MAY3D,OACE,yBAAKE,UAAU,OAAf,YACW,2BAAOhJ,KAAK,SAASiJ,MAAOP,EAAOQ,SAAU,SAAApB,GAAC,OAAIa,EAASQ,SAASrB,EAAEsB,OAAOH,MAAO,MAAMI,IAAK,GAAIC,IAAK,MACjH,kBAACC,GAAD,MACA,kBAACC,EAAD,CAAW9H,IAAKgH,GACd,kBAACe,GAAD,CAASnE,MAAM,SACb,kBAAC,IAAD,CAAYoE,IAAKtB,EAAWuB,eAAe,OAAOzJ,MAAOqB,EAAIqI,qBAE9DrI,EAAIrB,MAAMnC,KAAI,SAAAkC,GAAI,OAAI,kBAAC4J,EAAD,iBAAY5J,EAAZ,CAAkB/B,IAAK+B,EAAKrB,KAAM8C,IAAKgH,EAAQzI,EAAKO,QAASuB,OAAQ,kBAAMqG,EAAUS,SAAWT,EAAUS,QAAQiB,aAAa,CAAC7J,EAAKE,cAAc+B,OAAQ6H,SAElL,kBAACN,GAAD,CAASnE,MAAM,QACb,kBAAC,IAAD,CAAYoE,IAAKpB,EAAUqB,eAAe,OAAOK,YAAazI,EAAI0I,wBAGnE1I,EAAIlB,QAAQtC,KAAI,SAAAmM,GAAK,OAAI,kBAACL,EAAD,iBAAYK,EAAZ,CAAmBhM,IAAKgM,EAAMtL,KAAM8C,IAAKgH,EAAQwB,EAAM1J,QAASuB,OAAQ,gBAAGnB,EAAH,EAAGA,QAASC,EAAZ,EAAYA,SAAZ,OAA2BuH,EAAUS,SAAWT,EAAUS,QAAQE,aAAamB,EAAM/J,WAAY+J,EAAMtJ,SAAWA,GAAW,CAAC,IAAKC,GAAY,IAAIqB,OAAQ6H,SAE7P,kBAACN,GAAD,CAASnE,MAAM,SACb,kBAAC6E,GAAD,OAED5I,EAAI6I,WAAWrM,KAAI,SAAAmM,GAAK,OAAI,kBAACL,EAAD,iBAAYK,EAAZ,CAAmBhM,IAAKgM,EAAMtL,KAAM8C,IAAKgH,EAAQwB,EAAM1J,QAAS0B,OAAQ6H,KAAsB,2BAAOM,GAAIH,EAAMtL,KAAM0L,UAAQ,EAACC,IAAKL,EAAM9C,eAIxK,kBAACqC,GAAD,CAASnE,MAAM,QACb,kBAAC,IAAD,CAAYoE,IAAKnB,EAAUoB,eAAe,OAAOK,YAAa,CAAC,EAAG,EAAG,EAAG,IAAK,OAC7E,2BAAOhK,KAAK,SAASiJ,MAAOT,EAAYU,SAAU,SAAApB,GAAC,OAjChC3H,EAiCoDgJ,SAASrB,EAAEsB,OAAOH,MAAO,IAhCpG1J,QAAQC,IAAI,6BAA8BW,GACtCoI,EAASM,UACXN,EAASM,QAAQ2B,gBAAgBrK,GACjCoI,EAASM,QAAQ4B,OAAOC,OAAOC,UAAS,kBAAM/B,EAAU,aAE1DH,EAActI,GANQ,IAACA,GAiCmFkJ,IAAK,EAAGC,IAAK,QAGrH,kBAACsB,GAAD,CAAerF,SAAU,SAACsF,GAAD,OAAUjC,EAAUiC,UCxD/BC,QACW,cAA7BzD,OAAO0D,SAASC,UAEe,UAA7B3D,OAAO0D,SAASC,UAEhB3D,OAAO0D,SAASC,SAASC,MACvB,2DCZNC,IAAShJ,OAAO,kBAAC,GAAD,MAASmE,SAAS8E,eAAe,SDmI3C,kBAAmBC,WACrBA,UAAUC,cAAcC,MAAMC,MAAK,SAAAC,GACjCA,EAAaC,kB","file":"static/js/main.dd5e674e.chunk.js","sourcesContent":["import React from 'react';\nimport styled from 'styled-components';\nimport { LooperRendererProps, BeatStylesProps } from './Looper';\n\n\nexport const DefaultRythmStyles = styled.div`\n  display: flex;\n`;\n\nexport const DefaultBeatStyles = styled.div<BeatStylesProps>`\n  ${props => props.active && `\n    color: green;\n    font-weight: bold;\n  `}\n`;\n\nexport default ({ playBeat, step }: LooperRendererProps) => (\n  <DefaultRythmStyles>\n    {(playBeat && playBeat.map((beat, index) => <DefaultBeatStyles active={index === step} key={index}>{beat}</DefaultBeatStyles>)) || null}\n  </DefaultRythmStyles>\n);\n","import styled from 'styled-components';\n\nexport const LooperControlStyles = styled.div`\n  display: flex;\n`;\n\nconst LooperStyles = styled.div`\n  display: flex;\n\n  * {\n    flex: 1 1 auto;\n  }\n\n  ${LooperControlStyles} {\n    flex: 0 0 auto;\n  }\n`;\n\nexport const Name = styled.b`\n  flex: 0 0 auto;\n  width: 100px;\n  text-overflow: ellipsis;\n  overflow: hidden;\n\n  * {\n    flex: 0 0 auto;\n    max-width: 100px;\n  }\n`;\n\n\nexport default LooperStyles;\n","import styled from 'styled-components';\n\n// TODO: xstate\n\nexport interface ControlButtonProps {\n  active?: boolean;\n}\n\nexport const ControlButton = styled.button<ControlButtonProps>`\n  background-color: lightgray;\n  border: solid 1px gray;\n  border-radius: 4px;\n\n  ${props => props.active && `\n    background-color: green;\n  `}\n`;\n","export type PlayBeatType = number[];\n\nexport enum PlayTypes {\n  all = 'all',\n  odd = 'odd',\n  even = 'even',\n  oddQuarter = 'quarter',\n  evenQuarter = 'evenQuarter',\n  first = 'first',\n  last = 'last',\n}\n\n\nexport enum TrackType {\n  // instruments\n  drum = 110,\n  bass = 120,\n  string = 130,\n  key = 190,\n  // brass\n  // pad\n\n  recording = 101,\n  other = 900,\n}\n","import React from 'react';\nimport { LooperControlStyles, Name } from './LooperStyles';\nimport { ControlButton } from './ControlButton';\nimport { TrackControlProps } from './model/stores/TrackStore';\n\nexport interface LooperControlProps extends TrackControlProps {\n  setMuted: (a: boolean) => void;\n  children?: JSX.Element;\n}\n\nexport const DefaultLooperControl = ({\n  name, muted, setMuted, children,\n}: LooperControlProps) => (\n  <LooperControlStyles>\n    <Name>\n      {name}\n      {/* TODO: https://github.com/surikov/midi-sounds-react-examples/blob/master/examples/midi-sounds-example4/src/App.js */}\n      {children}\n    </Name>\n    <ControlButton onClick={() => setMuted(!muted)} active={muted}>Mute</ControlButton>\n  </LooperControlStyles>\n);\n","import {\n  computed, observable, action,\n} from 'mobx';\nimport { PlayTypes, PlayBeatType, TrackType } from '../types';\n\nexport interface TrackControlProps {\n  name: string;\n  // TODO\n  muted?: boolean;\n}\n\nexport interface PitchedSound {\n  pitches?: number[];\n  duration?: number;\n}\n\nexport interface MidiSoundConfigProps {\n  instrument: number;\n}\n\nexport interface AudioSoundConfigProps {\n  blobUrl?: string;\n}\n\nexport interface SoundConfigProps extends MidiSoundConfigProps, AudioSoundConfigProps{\n  type: TrackType;\n  divider: number;\n  playType?: PlayTypes;\n  playSound?: () => void;\n}\n\ninterface TrackSoundProps extends SoundConfigProps, PitchedSound {\n  // TODO\n  playBeat?: PlayBeatType;\n}\n\n\ninterface TrackProps extends TrackSoundProps, TrackControlProps {\n\n}\n\nconst defaultArray: number[] = [];\nconst flattenArray = (array: (number | number[])[]) => defaultArray.slice().concat.apply([], array);\n\nconsole.log('REACT_APP_MUTE_ALL_TRACK', process.env.REACT_APP_MUTE_ALL_TRACK);\n\n// https://stackoverflow.com/questions/52641907/how-to-get-mobx-decorators-to-work-with-create-react-app-v2\nexport default class TrackStore {\n  // constructor() {\n  // }\n\n\n  @observable tracks: TrackProps[] = [{\n    name: 'kickdrum',\n    type: TrackType.drum,\n    instrument: 1,\n    divider: 2,\n    playType: PlayTypes.oddQuarter,\n    muted: process.env.REACT_APP_MUTE_ALL_TRACK === 'true', // TODO: disable\n  },\n  {\n    name: 'kickdrum variety',\n    type: TrackType.drum,\n    instrument: 1,\n    divider: 2,\n    playBeat: [0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1],\n    muted: process.env.REACT_APP_MUTE_ALL_TRACK === 'true', // TODO: disable\n  },\n  {\n    name: 'cin',\n    type: TrackType.drum,\n    instrument: 39,\n    divider: 4,\n    playType: PlayTypes.even,\n    muted: process.env.REACT_APP_MUTE_ALL_TRACK === 'true', // TODO: disable\n  },\n  {\n    name: 'snaredrum',\n    type: TrackType.drum,\n    instrument: 16,\n    divider: 1,\n    playType: PlayTypes.even,\n    muted: process.env.REACT_APP_MUTE_ALL_TRACK === 'true', // TODO: disable\n  },\n  // {\n  //   name: 'korgbass',\n  //   type: TrackType.bass,\n  //   instrument: 376,\n  //   pitches: [30],\n  //   duration: 1,\n  //   divider: 4,\n  //   playType: PlayTypes.odd,\n  // },\n  {\n    name: 'korgbass 2',\n    type: TrackType.bass,\n    instrument: 371,\n    pitches: [30],\n    duration: 1,\n    divider: 4,\n    playType: PlayTypes.odd,\n    muted: process.env.REACT_APP_MUTE_ALL_TRACK === 'true', // TODO: disable\n  },\n  {\n    name: 'quitar1',\n    type: TrackType.bass,\n    instrument: 307,\n    duration: 1,\n    divider: 2,\n    playBeat: [\n      50, 0, 53, 54, 55, 0, 50, 0,\n      50, 0, 53, 54, 55, 0, 50, 0,\n      50, 0, 53, 54, 55, 0, 50, 0,\n      51, 0, 54, 55, 56, 0, 52, 0,\n      // 0, 30, 0, 0, 32, 0, 30, 0,\n      // 0, 30, 0, 32, 36, 0, 30, 0,\n      // 0, 30, 0, 0, 30, 30, 0, 0,\n    ],\n    muted: process.env.REACT_APP_MUTE_ALL_TRACK === 'true', // TODO: disable\n  },\n  ];\n\n  @computed public get drums() {\n    return this.tracks\n      .filter(track => track.type === TrackType.drum);\n  }\n\n  @computed public get drumInstrumentIds() {\n    return flattenArray(this.drums.map(track => track.instrument));\n  }\n\n  @computed public get bassers() {\n    return this.tracks\n      .filter(track => track.type === TrackType.bass);\n  }\n\n  @computed public get bassersInstrumentIds() {\n    return flattenArray(this.bassers.map(track => track.instrument));\n  }\n\n  @computed public get recordings() {\n    return this.tracks\n      .filter(track => track.type === TrackType.recording);\n  }\n\n  @action _update(track: TrackControlProps) {\n    console.log('_update', track);\n    this.tracks = this.tracks.slice().map(t => (t.name === track.name ? { ...t, ...track }: t));\n    // console.log('this.tracks', this.tracks);\n  }\n\n  @action _remove(track: TrackControlProps) {\n    console.log('remove ', track);\n  }\n\n  @action _add(track: TrackProps) {\n    console.log('add new ', track);\n    this.tracks = this.tracks.slice().concat(track);\n  }\n\n  // bind this\n  @action add = this._add.bind(this);\n\n  @action remove = this._remove.bind(this);\n\n  @action update = this._update.bind(this);\n\n  @action mute = this._update.bind(this);\n}\n","import {\n  computed, observable, action,\n} from 'mobx';\n\nexport default class MetronomeStore {\n  @computed public get step() {\n    return 0.0;\n  }\n}\n","import { createContext } from 'react';\nimport TrackStore from './TrackStore';\nimport MetronomeStore from './MetronomeStore';\n\n\nconst trackStore = new TrackStore();\nconst metronomeStore = new MetronomeStore();\nconst stores = {\n  trx: trackStore,\n  mtn: metronomeStore,\n};\n\n// Use the React context API so that the stores are available anywhere in the app\nexport default createContext(stores);\nexport { stores };\n","import React, { useEffect, useState, useContext } from 'react';\nimport DefaultLooperRenderer from './DefaultLooperRenderer';\nimport { LooperControlProps, DefaultLooperControl } from './LooperControls';\nimport LooperStyles from './LooperStyles';\nimport { PlayBeatType, PlayTypes } from './model/types';\nimport { PitchedSound } from './model/stores/TrackStore';\nimport StoreContext from './model/stores';\n\nexport interface BeatStylesProps {\n  active: boolean;\n  enabled?: boolean;\n}\n\n\nexport interface LooperRendererProps {\n  playBeat: PlayBeatType;\n  step: number;\n  setPlayBeat?: (playBeat: PlayBeatType) => void;\n}\n\n\nexport interface BasicLooperProps {\n  playType?: PlayTypes;\n  rythmLength?: number; // needs to be injected\n}\n\nexport interface GeneratePlayBeatProps extends BasicLooperProps {\n  multiplier: number; // needs to be injected\n}\n\nexport interface LooperProps extends BasicLooperProps {\n  bpm?: number;\n  looping?: boolean;\n  source?: (arg0: PitchedSound) => void;\n  playSound?: () => void;\n  step?: number; // needs to be injected\n  metronomeBpm?: number;\n  render?: (props: LooperRendererProps) => JSX.Element;\n  control?: (props: LooperControlProps) => JSX.Element;\n  playBeat?: PlayBeatType;\n  duration?: number;\n  name: string;\n  muted?: boolean;\n  children?: JSX.Element;\n}\n\n\n// TODO: test\nconst generatePlayBeat = ({ playType, rythmLength, multiplier }: GeneratePlayBeatProps): number[] => {\n  const length = (rythmLength || 0) * multiplier;\n  // console.log('generatePlayBeat', playType, length, '(', rythmLength, ' || 0) * ', multiplier);\n  switch (playType) {\n  case PlayTypes.odd:\n    return new Array(length).fill(0).map((_qwe, index) => 1 - (index % 2));\n  case PlayTypes.even:\n    return new Array(length).fill(0).map((_qwe, index) => index % 2);\n  case PlayTypes.oddQuarter:\n    return new Array(length).fill(0).map((_qwe, index) => (index % 4 ? 0 : 1));\n  case PlayTypes.evenQuarter:\n    return new Array(length).fill(0).map((_qwe, index) => (index % 4 === 2 ? 1 : 0));\n  case PlayTypes.first:\n    return new Array(length).fill(0).map((_qwe, index) => (index === 0 ? 1 : 0));\n  case PlayTypes.last:\n    return new Array(length).fill(0).map((_qwe, index) => (index === length - 1 ? 1 : 0));\n  case PlayTypes.all:\n  default:\n    return new Array(length).fill(1);\n  }\n};\n\n\nexport default ({\n  bpm,\n  metronomeBpm,\n  looping = true,\n  rythmLength,\n  playType = PlayTypes.odd,\n  playBeat: originalPlayBeat,\n  source,\n  playSound,\n  step,\n  render: renderProp,\n  control: controlProp,\n  name,\n  duration,\n  muted,\n  children,\n}: LooperProps) => {\n  const multiplier = (bpm && metronomeBpm && bpm / metronomeBpm) || 1;\n  const getStep = (step || 0) * multiplier;\n  const { trx } = useContext(StoreContext);\n  const LooperRenderer = renderProp || DefaultLooperRenderer;\n  const ControlRenderer = controlProp || DefaultLooperControl;\n  const [playBeat, setPlayBeat] = useState((originalPlayBeat && originalPlayBeat.slice())|| generatePlayBeat({ playType, rythmLength, multiplier }));\n  const setMuted = () => trx.mute({ name, muted: !muted });\n\n  const playSource = () => {\n    if (playBeat[getStep] && !muted) {\n      if (source) source({ pitches: [playBeat[getStep]], duration });\n      if (playSound) playSound();\n    }\n  };\n\n\n  useEffect(() => {\n    if (looping) {\n      playSource();\n    }\n  }, [step, looping]);\n\n  return (\n    <LooperStyles>\n      <ControlRenderer muted={!!muted} setMuted={setMuted} name={name}>{children}</ControlRenderer>\n      <LooperRenderer playBeat={playBeat} step={getStep} setPlayBeat={(thisPlayBeat) => setPlayBeat(thisPlayBeat)} />\n    </LooperStyles>\n  );\n};\n","import React, { useEffect, useState } from 'react';\n\nexport interface LooperProps {\n  bpm?: number;\n  looping?: boolean;\n  source?: () => void;\n  rythmLength?: number;\n  rythmDivider?: number;\n  children: JSX.Element | JSX.Element[] | any; // TODO: resolve not to use any for mapped Looper items\n}\n\nconst defaultRrythmLength = 8;\n// TODO: half & quarter rythm support\nexport const defaultBPM = 60;\n\nexport default ({\n  bpm = defaultBPM,\n  looping = true,\n  rythmLength = defaultRrythmLength,\n  rythmDivider = defaultRrythmLength * 2,\n  children,\n}: LooperProps) => {\n  const [start, setStart] = useState(new Date());\n  const [step, setStep] = useState(0.0);\n  const [metronome, setMetronome] = useState<number>(); // NodeJS.Timeout\n  const interval = (60 / bpm) * 1000; // we want to have /2, /4, /8 support\n\n  const init = () => {\n    setStart(new Date());\n  };\n\n  const calculateStep = () => {\n    const diff = (new Date().getTime() - start.getTime()) / interval;\n    const newStep = Math.floor(diff) % rythmLength;\n    const divider = Math.floor((diff - Math.floor(diff)) * rythmLength) / 8;\n    // console.log('step + divider', step, newStep + divider);\n    setStep(newStep + divider);\n  };\n\n  useEffect(() => {\n    if (looping) {\n      init();\n      // TODO: refactor metronome to global\n      if (metronome) clearTimeout(metronome);\n      // console.log('interval / rythmDivider', interval / rythmDivider);\n      setMetronome(setInterval(() => calculateStep(), interval / rythmDivider));\n    }\n  }, [interval, looping]);\n\n  const newChildren = React.Children.map(children, child => React.cloneElement(child, {\n    metronomeBpm: bpm,\n    step,\n    rythmLength,\n  }));\n\n  return (\n    <>\n      <h1>{step}</h1>\n      {newChildren}\n    </>\n  );\n};\n","import React from 'react';\nimport styled from 'styled-components';\nimport { LooperRendererProps, BeatStylesProps } from './Looper';\n\n\nexport const RythmStyles = styled.div`\n  display: flex;\n`;\n\nexport const BeatStyles = styled.button<BeatStylesProps>`\n  border-radius: 4px;\n  border: solid 1px black;\n  background: gray;\n  margin: 3px;\n  flex: 1 1 auto;\n  height: 50px;\n  overflow: hidden;\n  color: #515e2d;\n\n  ${props => !props.enabled && props.active && `\n    background: #999;\n  `}\n\n  ${props => props.enabled && `\n    background: #515e2d;\n  `}\n  ${props => props.enabled && props.active && `\n    background: rgb(180,193,38);\n    background: radial-gradient(circle, rgba(180,193,38,1) 35%, rgba(112,125,76,1) 100%);\n  `}\n`;\n\n\nexport default ({ playBeat, step, setPlayBeat }: LooperRendererProps) => {\n  const updateBeat = (index: number) => {\n    if (!setPlayBeat) return ;\n    const newPlayBeat = playBeat.slice();\n    newPlayBeat[index] = !newPlayBeat[index] ? 1 : 0;\n    setPlayBeat(newPlayBeat)\n  };\n  return (\n    <RythmStyles>\n      {(playBeat && playBeat.map((beat, index) => <BeatStyles active={index === step} enabled={beat > 0} key={index} onClick={() => updateBeat(index)}>{beat}</BeatStyles>)) || null}\n    </RythmStyles>\n  );\n}\n","import styled from 'styled-components';\n\nexport default styled.section`\n  display: flex;\n  font-size: 2rem;\n  font-weight: bold;\n  align-items: center;\n  justify-content: flex-start;\n\n  ${props => props.title && `\n    &:before {\n      content: '${props.title}:';\n      text-decoration: underline;\n    }\n  `}\n\n  .MIDISounds {\n    margin: 0px 10px;\n    &>* {\n      display: flex;\n      align-items: center;\n\n      &:after {\n        content: 'config';\n        font-size: initial;\n      }\n    }\n    svg {\n      width: 40px;\n      height: 30px;\n    }\n  }\n`;\n","import React from 'react';\nimport { Piano, KeyboardShortcuts, MidiNumbers } from 'react-piano';\nimport 'react-piano/dist/styles.css';\n\nexport interface PianoKeyboardProps {\n  playNote: (number: number) => void;\n}\n\nexport default ({ playNote }: PianoKeyboardProps) => {\n  const firstNote = MidiNumbers.fromNote('c3');\n  const lastNote = MidiNumbers.fromNote('f5');\n  const keyboardShortcuts = KeyboardShortcuts.create({\n    firstNote: firstNote,\n    lastNote: lastNote,\n    keyboardConfig: KeyboardShortcuts.HOME_ROW,\n  });\n\n  return (\n    <Piano\n      noteRange={{ first: firstNote, last: lastNote }}\n      playNote={playNote}\n      stopNote={(midiNumber: number) => {\n        // console.log('stop midiNumber', midiNumber);\n      }}\n      width={document.body.clientWidth}\n      keyboardShortcuts={keyboardShortcuts}\n    />\n  );\n}","import React from 'react';\nimport styled from 'styled-components';\n\nconst RootControlsStyles = styled.div``;\n\nexport default () => (\n  <RootControlsStyles>\n    TODO:SLIDER\n  </RootControlsStyles>\n);","import React, { useState, useContext } from 'react';\nimport { Recorder } from 'vmsg';\n// import { ReactMic } from 'react-mic';\n// import _ from 'lodash.get';\n// import MicRecorder from 'mic-recorder';\n// import { Machine, interpret } from 'xstate';\n\nimport { TrackType, PlayTypes } from '../model/types';\nimport { ControlButton } from '../ControlButton';\nimport LooperStyles from '../LooperStyles';\nimport StoresContext from '../model/stores';\n\nconst recorder = new Recorder({\n  wasmURL: 'https://unpkg.com/vmsg@0.3.0/vmsg.wasm',\n});\n\n\n// https://jonbellah.com/articles/xstate-react-hooks/\n// const recordState = Machine({\n//   id: 'record',\n//   initial: 'inactive',\n//   states: {\n//     inactive: { on: { start: 'recording' } },\n//     recording: { on: { stop: 'inactive' } },\n//   },\n// });\n\ninterface ReactMicStoppedProps {\n  blobUrl: string;\n}\n\nexport default () => {\n  const [recording, setRecording] = useState(false);\n  // const [ready, setReady] = useState('');\n  const { trx } = useContext(StoresContext);\n  // const audioRef = useRef(null);\n  // eslint-disable-next-line no-undef\n  // const audio = new Audio();\n\n  // New instance\n  // const recorder = new MicRecorder({\n  //   bitRate: 128,\n  //   encoder: 'mp3', // default is mp3, can be wav as well\n  //   sampleRate: 44100, // default is 44100, it can also be set to 16000 and 8000.\n  // });\n\n  // const start = () => {\n  //   setRecording(true);\n  //   // Start recording. Browser will request permission to use your microphone.\n  //   console.log('recorder', recorder);\n  //   recorder.start().then(() => {\n  //     // something else\n  //   }).catch((e) => {\n  //     console.error(e);\n  //   });\n  // };\n\n  // const stop = () => {\n  //   setRecording(false);\n  //   console.log('recorder', recorder);\n  //   // Once you are done singing your best song, stop and get the mp3.\n  //   recorder\n  //     .stop()\n  //     .getAudio()\n  //     .then(([buffer, blob]) => {\n  //       // do what ever you want with buffer and blob\n  //       // Example: Create a mp3 file and play\n  //       console.log('buffer', buffer, blob);\n  //       // const file = new File(buffer, 'me-at-thevoice.mp3', {\n  //       //   type: blob.type,\n  //       //   lastModified: Date.now(),\n  //       // });\n\n  //       // const player = new Audio(URL.createObjectURL(file));\n  //       // player.play();\n  //     }).catch((e) => {\n  //       console.error('We could not retrieve your message');\n  //       console.log(e);\n  //     });\n  // };\n\n  const startRecording = async () => {\n    setRecording(true);\n    await recorder.initAudio();\n    await recorder.initWorker();\n    recorder.startRecording();\n  };\n\n  const stopRecording = async () => {\n    setRecording(false);\n    const blob = await recorder.stopRecording();\n    const blobUrl = window.URL.createObjectURL(blob);\n    const name = `au${blobUrl.replace(/.*-/, '')}`;\n    // console.log('bloburl', blob.size, blobUrl, name);\n    trx.add({\n      name,\n      type: TrackType.recording,\n      divider: 1,\n      instrument: 0,\n      blobUrl,\n      playType: PlayTypes.first,\n      playSound: () => {\n        const audioNode = document.querySelector(`#${name}`);\n        if (audioNode) {\n          // console.log(audioNode, (audioNode as HTMLAudioElement).paused);\n          try {\n            (audioNode as HTMLAudioElement).currentTime=0; // TODO: not working on Safari\n            (audioNode as HTMLAudioElement).play(); // TODO: not working on Safari\n          } catch (e) {\n            console.error(e);\n          }\n        }\n      },\n    });\n    // await setReady('');\n\n    setTimeout(() => {\n      // setReady(blobUrl);\n      recorder.close();\n    }, 100);\n    // setTimeout(() => {\n    //   console.log('audioRef', audioRef.current);\n    //   if (audioRef && audioRef.current) {\n    //     console.log('blob', blob);\n    //     console.log('audio element', (audioRef.current as unknown as HTMLAudioElement));\n    //     console.log('audio element', (audioRef.current as unknown as HTMLAudioElement).currentSrc);\n    //     // (audioRef.current as unknown as HTMLAudioElement).src=blobUrl;\n    //   }\n    // }, 6000);\n    // setTimeout(() => {\n    //   console.log('play audio', audio);\n    //   if (audio && containerRef.current) {\n    //     audio.src=blobUrl;\n    //     audio.controls = true;\n    //     (containerRef.current as unknown as HTMLElement).appendChild(audio);\n    //     audio.play().then(() => console.log('played')).catch(e => console.log('play error', e));\n    //   }\n    // }, 10000);\n  };\n\n  // const onStop = (recordedBlob: Blob) => {\n  //   const blobUrl = _(recordedBlob, 'blobURL', '');\n  //   setReady(blobUrl);\n  // };\n\n\n  return (\n    <LooperStyles>\n      {!recording && <ControlButton onClick={() => startRecording()}>Record</ControlButton>}\n      {recording && <ControlButton onClick={() => stopRecording()}>stop</ControlButton>}\n      {/* <ReactMic\n        record={recording}\n        visualSetting=\"sinewave\" // defaults -> \"sinewave\".  Other option is \"frequencyBars\"\n        // className={string}       // provide css class name\n        onStop={onStop} // called when audio stops recording\n        // onData={function}        // called when chunk of audio data is available\n        // strokeColor={string}     // sinewave or frequency bar color\n        // backgroundColor={string} // background color\n      /> */}\n      {/* {ready && !recording && (\n        <audio controls>\n          <source src={ready} type=\"audio/mpeg\" />\n        </audio>\n      )} */}\n      {/* <small style={{ flex: '0 0 0' }}>{ready}</small> */}\n      {/* <audio controls>\n        <source src=\"https://raw.githubusercontent.com/pitiboy/loopin/master/sound/storm-thunder.mp3\" type=\"audio/mp3\" />\n      </audio> */}\n    </LooperStyles>\n  );\n};\n","import React, { useRef, useState, useContext } from 'react';\nimport { observer } from 'mobx-react';\nimport MIDISounds from 'midi-sounds-react';\n// import Looper from 'react-looper';\nimport Looper from './Looper';\nimport './App.css';\nimport Metronome from './Controls/Metronome';\nimport SquareLooperRenderer from './SquareLooperRenderer';\nimport Section from './Layout/Section';\nimport PianoKeyboard from './Layout/PianoKeyboard';\nimport RootControls from './Controls/RootControls';\nimport StoreContext from './model/stores';\nimport MicRecorder from './Controls/MicRecorder';\n\n\nconst App: React.FC = observer(() => {\n  const midiDrums = useRef<MIDISoundsType>(null);\n  const midiBass = useRef<MIDISoundsType>(null);\n  const midiKeys = useRef<MIDISoundsType>(null);\n  const [pianoChord, setPianoChord] = useState(847);\n  const [myBPM, setMyBPM] = useState(80);\n  const { trx } = useContext(StoreContext);\n\n  // TODO: strings Keys, , Strings\n  const playChord = (pitches: number | number[]) => {\n    if (midiKeys !== null && midiKeys.current !== null) {\n      const defaultPitches: number[] = [];\n      const playPitches = defaultPitches.concat(pitches);\n      midiKeys.current.playChordNow(pianoChord, playPitches, 0.5);\n    }\n  };\n\n  const cacheInstrument = (instrument: number) => {\n    console.log('trying to cache instrument', instrument);\n    if (midiKeys.current) {\n      midiKeys.current.cacheInstrument(instrument);\n      midiKeys.current.player.loader.waitLoad(() => playChord(50));\n    }\n    setPianoChord(instrument);\n  };\n  return (\n    <div className=\"App\">\n      set BPM: <input type=\"number\" value={myBPM} onChange={e => setMyBPM(parseInt(e.target.value, 10))} min={30} max={300} />\n      <RootControls />\n      <Metronome bpm={myBPM}>\n        <Section title=\"Drums\">\n          <MIDISounds ref={midiDrums} appElementName=\"root\" drums={trx.drumInstrumentIds} />\n        </Section>\n        {trx.drums.map(drum => <Looper {...drum} key={drum.name} bpm={myBPM * drum.divider} source={() => midiDrums.current && midiDrums.current.playDrumsNow([drum.instrument])} render={SquareLooperRenderer} />)}\n\n        <Section title=\"Bass\">\n          <MIDISounds ref={midiBass} appElementName=\"root\" instruments={trx.bassersInstrumentIds} />\n          {/* <input type=\"number\" value={bassChord} onChange={e => setBassChord(parseInt(e.target.value, 10))} min={366} max={446} /> */}\n        </Section>\n        {trx.bassers.map(chord => <Looper {...chord} key={chord.name} bpm={myBPM * chord.divider} source={({ pitches, duration }) => midiDrums.current && midiDrums.current.playChordNow(chord.instrument, chord.pitches || pitches || [30], duration || 1)} render={SquareLooperRenderer} />)}\n\n        <Section title=\"Voice\">\n          <MicRecorder />\n        </Section>\n        {trx.recordings.map(chord => <Looper {...chord} key={chord.name} bpm={myBPM * chord.divider} render={SquareLooperRenderer}><audio id={chord.name} controls src={chord.blobUrl} /></Looper>)}\n      </Metronome>\n\n\n      <Section title=\"Keys\">\n        <MIDISounds ref={midiKeys} appElementName=\"root\" instruments={[1, 2, 3, 305, 847]} />\n        <input type=\"number\" value={pianoChord} onChange={e => cacheInstrument(parseInt(e.target.value, 10))} min={0} max={1393} />\n      </Section>\n\n      <PianoKeyboard playNote={(note) => playChord(note)} />\n    </div>\n  );\n});\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}